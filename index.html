<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>성실 레벨 업 프로젝트 — PWA</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0f172a">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    html,body{height:100%}
    .card{ border-radius:1rem; border:1px solid #e2e8f0; background:#fff; box-shadow:0 1px 2px rgba(0,0,0,.04); }
    .btn{ display:inline-flex; align-items:center; justify-content:center; padding:.5rem .75rem; border-radius:.75rem; border:1px solid #cbd5e1; background:#fff; }
    .btn:hover{ background:#f8fafc }
    .btn-primary{ background:#0f172a; color:#fff; border-color:#0f172a }
    .btn-ghost{ border-color:transparent }
    .input{ width:100%; border:1px solid #cbd5e1; border-radius:.75rem; padding:.5rem .75rem }
    .label{ font-size:.75rem; color:#475569 }
    .switch{ width:38px; height:22px }
    .switch input{ display:none }
    .switch span{ display:block; width:100%; height:100%; background:#e2e8f0; border-radius:9999px; position:relative; transition:.2s }
    .switch span:after{ content:''; position:absolute; top:2px; left:2px; width:18px; height:18px; background:#fff; border-radius:9999px; transition:.2s; box-shadow:0 1px 2px rgba(0,0,0,.2) }
    .switch input:checked + span{ background:#0f172a }
    .switch input:checked + span:after{ transform:translateX(16px) }
    .pixelate{ image-rendering: pixelated }
  </style>
</head>
<body class="min-h-full bg-gradient-to-b from-slate-50 to-white text-slate-900 p-4 md:p-8">
  <div id="root"></div>

  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("./sw.js").catch(()=>{});
      });
    }
  </script>

  <script type="text/babel">
    const CATEGORIES = ['다이어트','그림','코딩/자격증','영어','생활 교양','책 쓰기','생활 습관'];
    const LS_KEY = 'diligence-level-up-app.v1';
    const fmtDate = d => new Date(d).toISOString().slice(0,10);
    const todayStr = fmtDate(new Date());
    const defaultWeeklyGoals = [
      { category: '그림', targetCount: 5, achievedCount: 0 },
      { category: '코딩/자격증', targetCount: 4, achievedCount: 0 },
      { category: '영어', targetCount: 5, achievedCount: 0 },
      { category: '다이어트', targetCount: 5, achievedCount: 0 },
      { category: '생활 습관', targetCount: 4, achievedCount: 0 },
      { category: '생활 교양', targetCount: 2, achievedCount: 0 },
      { category: '책 쓰기', targetCount: 2, achievedCount: 0 },
    ];
    const defaultInventory = () => ({
      fragments: { '탐식의 마도서':0, '환식의 계약서':0, '현자의 보급 주문서':0, '소망의 결정':0 },
      items: { '탐식의 마도서':0, '환식의 계약서':0, '현자의 보급 주문서':0, '소망의 결정':0 },
    });
    const seedMissions = () => ([
      { id: crypto.randomUUID(), title:'유산소 운동 40분', category:'다이어트', plannedXp:40, done:false, pixelate:true },
      { id: crypto.randomUUID(), title:'크로키 2장', category:'그림', plannedXp:35, done:false, pixelate:true },
      { id: crypto.randomUUID(), title:'C 강의 1강', category:'코딩/자격증', plannedXp:30, done:false },
      { id: crypto.randomUUID(), title:'영단어 암기 30분', category:'영어', plannedXp:25, done:false },
    ]);
    const clamp01 = x => Math.max(0, Math.min(1, x));
    const percent = n => Math.round(n*100);
    const xpForMission = (m, rates) => {
      const base = Number(m.plannedXp)||0;
      const extra = m.isExtra ? base * rates.extraMissionRate : base;
      return m.done ? extra : base * rates.xpPenaltyRate;
    };
    const save = (s) => localStorage.setItem(LS_KEY, JSON.stringify(s));
    const load = () => { try { const raw = localStorage.getItem(LS_KEY); return raw ? JSON.parse(raw) : null } catch { return null } };

    function App(){
      const [state, setState] = React.useState(() => load() ?? ({
        profile: { level: 8, xp: 309, nextLevelXp: 700 },
        weekNumber: 7,
        weeklyGoals: defaultWeeklyGoals,
        days: { [todayStr]: { date: todayStr, missions: seedMissions(), settled:false, dayXpAwarded:0 } },
        inventory: defaultInventory(),
        settings: { xpPenaltyRate:0.5, extraMissionRate:0.6, minibossRewardFragments:1, locale:'ko-KR' },
        quickNote: ''
      }));
      const [selectedDate, setSelectedDate] = React.useState(todayStr);

      React.useEffect(()=>{ save(state); }, [state]);

      const day = React.useMemo(()=> state.days[selectedDate] ?? { date:selectedDate, missions:[], settled:false, dayXpAwarded:0 }, [state, selectedDate]);

      React.useEffect(()=>{
        if(!state.days[selectedDate]){
          setState(prev=> ({...prev, days:{...prev.days, [selectedDate]: { date:selectedDate, missions:[], settled:false, dayXpAwarded:0 } }}));
        }
      }, [selectedDate]);

      const completionRate = React.useMemo(()=>{
        const total = day.missions.length || 1;
        const done = day.missions.filter(m=>m.done).length;
        return done/total;
      }, [day.missions]);

      const minibossChance = percent(clamp01(completionRate * 1.2));

      function addMission(partial={}){
        const m = { id:crypto.randomUUID(), title:'새 미션', category:'생활 습관', plannedXp:20, done:false, ...partial };
        setState(prev=> ({...prev, days:{...prev.days, [selectedDate]: {...day, missions:[...day.missions, m] }}}));
      }
      function updateMission(id, patch){
        setState(prev=> ({...prev, days:{...prev.days, [selectedDate]: {...day, missions: day.missions.map(m=> m.id===id? {...m, ...patch}: m) }}}));
      }
      function removeMission(id){
        setState(prev=> ({...prev, days:{...prev.days, [selectedDate]: {...day, missions: day.missions.filter(m=>m.id!==id) }}}));
      }
      function settleDay(){
        if(day.settled) return;
        const { xpPenaltyRate, extraMissionRate } = state.settings;
        const awarded = Math.round(day.missions.reduce((s,m)=> s + xpForMission(m,{xpPenaltyRate, extraMissionRate}), 0));
        let level = state.profile.level;
        let xp = state.profile.xp + awarded;
        let next = state.profile.nextLevelXp;
        while(xp >= next){ xp -= next; level += 1; next = Math.round(next * 1.25); }
        const chance = minibossChance;
        const success = Math.random()*100 < chance;
        const inv = JSON.parse(JSON.stringify(state.inventory));
        if(success){
          const keys = ['탐식의 마도서','환식의 계약서','현자의 보급 주문서','소망의 결정'];
          const k = keys[Math.floor(Math.random()*keys.length)];
          inv.fragments[k] += state.settings.minibossRewardFragments;
          for(const key of keys){ while(inv.fragments[key] >= 5){ inv.fragments[key]-=5; inv.items[key]+=1; } }
        }
        const inc = {}; day.missions.filter(m=>m.done).forEach(m=>{ inc[m.category] = (inc[m.category]||0)+1; });
        const newWeekly = state.weeklyGoals.map(g=> ({...g, achievedCount: g.achievedCount + (inc[g.category]||0)}));
        const newDay = { ...day, settled:true, dayXpAwarded: awarded, minibossResult: success? '성공':'실패', minibossChance: chance };
        setState(prev=> ({...prev, profile:{level, xp, nextLevelXp:next}, days:{...prev.days, [selectedDate]: newDay}, weeklyGoals:newWeekly, inventory:inv }));
      }
      function resetWeek(){ if(!confirm('이번 주 진행도를 0으로 초기화할까요?')) return; setState(prev=> ({...prev, weekNumber: prev.weekNumber+1, weeklyGoals: prev.weeklyGoals.map(g=>({...g, achievedCount:0})) })); }
      function weeklyRewardInfo(){ return state.weeklyGoals.every(g=> g.achievedCount >= g.targetCount) ? '주간 보상 조건 달성! (전 항목 달성)' : '부분 달성: 보상 없음'; }
      function exportData(){ const blob = new Blob([JSON.stringify(state,null,2)], {type:'application/json'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download=`성실레벨업_${state.weekNumber}주차_${selectedDate}.json`; a.click(); URL.revokeObjectURL(url);}
      function importData(file){ const r = new FileReader(); r.onload=()=>{ try{ const s=JSON.parse(String(r.result)); setState(s); alert('데이터를 불러왔어요!'); }catch{ alert('가져오기 실패: JSON 형식 오류'); } }; r.readAsText(file); }

      const weekProgress = state.weeklyGoals.reduce((acc,g)=>{ acc.total += g.targetCount; acc.current += Math.min(g.achievedCount, g.targetCount); return acc; }, {total:0, current:0});

      return (
        <div className="max-w-6xl mx-auto grid gap-6">
          <div className="flex items-center justify-between gap-3">
            <div className="flex items-center gap-3">
              <div className="text-2xl">✨</div>
              <h1 className="text-2xl md:text-3xl font-bold">성실 레벨 업 프로젝트 (PWA)</h1>
              <span className="px-2 py-1 rounded-xl bg-slate-100 text-slate-700 text-sm">{state.weekNumber}주차</span>
            </div>
            <div className="flex items-center gap-2">
              <button className="btn" onClick={exportData}>⬇️ 내보내기</button>
              <label className="btn cursor-pointer">⬆️ 가져오기
                <input type="file" accept="application/json" className="hidden" onChange={e=>{ const f=e.target.files?.[0]; if(f) importData(f); }}/>
              </label>
            </div>
          </div>

          <div className="grid md:grid-cols-3 gap-4">
            <div className="card p-4">
              <div className="text-lg font-semibold mb-3">🛡️ 프로필</div>
              <div className="grid grid-cols-3 gap-3 items-end">
                <div>
                  <div className="label">레벨</div>
                  <input className="input" type="number" value={state.profile.level} onChange={e=> setState(p=>({...p, profile:{...p.profile, level:Number(e.target.value)}}))} />
                </div>
                <div>
                  <div className="label">경험치</div>
                  <input className="input" type="number" value={state.profile.xp} onChange={e=> setState(p=>({...p, profile:{...p.profile, xp:Number(e.target.value)}}))} />
                </div>
                <div>
                  <div className="label">다음 레벨 필요치</div>
                  <input className="input" type="number" value={state.profile.nextLevelXp} onChange={e=> setState(p=>({...p, profile:{...p.profile, nextLevelXp:Number(e.target.value)}}))} />
                </div>
              </div>
            </div>

            <div className="card p-4">
              <div className="text-lg font-semibold mb-3">📅 오늘</div>
              <div className="grid gap-3">
                <div className="flex items-center gap-2">
                  <input className="input" type="date" value={selectedDate} onChange={e=> setSelectedDate(e.target.value)} />
                  <button className="btn" onClick={()=> setSelectedDate(todayStr)}>오늘</button>
                </div>
                <div className="flex items-center justify-between">
                  <div className="text-sm text-slate-600">달성률</div>
                  <div className="text-lg font-semibold">{percent(completionRate)}%</div>
                </div>
                <div className="h-2 bg-slate-200 rounded-xl overflow-hidden"><div className="h-full bg-slate-900" style={{width:`${percent(completionRate)}%`}}/></div>
                <div className="flex items-center justify-between">
                  <div className="text-sm text-slate-600">미니보스 승률</div>
                  <div className="text-lg font-semibold">{minibossChance}%</div>
                </div>
                {day.settled ? (
                  <div className="text-sm text-emerald-700 bg-emerald-50 border border-emerald-200 rounded-xl p-2">
                    정산 완료 • 획득 XP {day.dayXpAwarded} • 미니보스 {day.minibossResult} ({day.minibossChance}%)
                  </div>
                ) : (
                  <button className="btn btn-primary w-full" onClick={settleDay}>🗡️ 하루 끝 · 정산</button>
                )}
              </div>
            </div>

            <div className="card p-4">
              <div className="text-lg font-semibold mb-3">🏆 주간 진행</div>
              <div className="space-y-3">
                <div className="text-sm text-slate-600">주간 종합 진행률</div>
                <div className="h-2 bg-slate-200 rounded-xl overflow-hidden"><div className="h-full bg-slate-900" style={{width:`${percent(weekProgress.current/Math.max(1,weekProgress.total))}%`}}/></div>
                <div className="text-sm">{weekProgress.current} / {weekProgress.total}</div>
                <div className="text-sm font-medium">{weeklyRewardInfo()}</div>
                <button className="btn" onClick={resetWeek}>주차 마감 & 초기화</button>
              </div>
            </div>
          </div>

          <Tabs
            tabs={[
              { key:'missions', label:'오늘의 미션', content: <Missions day={day} state={state} addMission={addMission} updateMission={updateMission} removeMission={removeMission} /> },
              { key:'weekly', label:'주간 목표', content: <Weekly state={state} setState={setState} /> },
              { key:'inventory', label:'인벤토리', content: <InventoryPanel state={state} setState={setState} /> },
              { key:'recommend', label:'추천 미션', content: <Recommended onAdd={addMission} /> },
              { key:'settings', label:'설정', content: <Settings state={state} setState={setState} /> },
            ]}
          />

          <div className="text-center text-xs text-slate-500 py-6">© {new Date().getFullYear()} 성실 레벨 업 프로젝트 · PWA</div>
        </div>
      );
    }

    function Tabs({tabs}){
      const [active, setActive] = React.useState(tabs[0]?.key);
      return (
        <div className="w-full">
          <div className="grid grid-cols-5 border rounded-xl overflow-hidden">
            {tabs.map(t=> (
              <button key={t.key} className={"px-3 py-2 text-sm " + (active===t.key? 'bg-slate-900 text-white':'bg-white hover:bg-slate-50')} onClick={()=> setActive(t.key)}>{t.label}</button>
            ))}
          </div>
          <div className="mt-4 card p-4">
            {tabs.find(t=>t.key===active)?.content}
          </div>
        </div>
      );
    }

    function Missions({day, state, addMission, updateMission, removeMission}){
      const { settings } = state;
      return (
        <div className="space-y-3">
          {day.missions.length===0 && <div className="text-sm text-slate-500">미션이 없습니다. 아래 버튼으로 추가해 보세요.</div>}
          {day.missions.map(m=> (
            <div key={m.id} className="border rounded-xl p-3 grid md:grid-cols-12 gap-2 items-center">
              <div className="md:col-span-3">
                <input className="input" aria-label="미션 제목" value={m.title} onChange={e=> updateMission(m.id, {title:e.target.value})} />
              </div>
              <div className="md:col-span-2">
                <select className="input" value={m.category} onChange={e=> updateMission(m.id, {category:e.target.value})}>
                  {CATEGORIES.map(c=> <option key={c} value={c}>{c}</option>)}
                </select>
              </div>
              <div className="md:col-span-2 flex items-end gap-2">
                <div className="flex-1">
                  <div className="label">예정 XP</div>
                  <input className="input" type="number" value={m.plannedXp} onChange={e=> updateMission(m.id, {plannedXp:Number(e.target.value)})} />
                </div>
                <label className="switch mt-6">
                  <input type="checkbox" checked={!!m.isExtra} onChange={e=> updateMission(m.id, {isExtra:e.target.checked})} />
                  <span></span>
                </label>
                <span className="text-xs">추가</span>
              </div>
              <div className="md:col-span-3">
                <textarea className="input" rows="2" placeholder="메모" value={m.notes||''} onChange={e=> updateMission(m.id, {notes:e.target.value})}></textarea>
                <div className="grid grid-cols-5 gap-2 mt-2 items-end">
                  <div className="col-span-3">
                    <div className="label">이미지 URL</div>
                    <input className="input" placeholder="https://..." value={m.imageUrl||''} onChange={e=> updateMission(m.id, {imageUrl:e.target.value})} />
                  </div>
                  <label className="col-span-2 flex items-center gap-2">
                    <span className="label">픽셀아트 모드</span>
                    <span className="switch"><input type="checkbox" checked={!!m.pixelate} onChange={e=> updateMission(m.id, {pixelate:e.target.checked})} /><span></span></span>
                  </label>
                </div>
              </div>
              <div className="md:col-span-2 flex items-center justify-end gap-2">
                <button className={"btn " + (m.done? 'btn-primary':'')} onClick={()=> updateMission(m.id, {done: !m.done})}>{m.done? '✅ 완료':'… 미완료'}</button>
                <button className="btn btn-ghost" onClick={()=> removeMission(m.id)}>🗑️</button>
              </div>
              {m.imageUrl && (
                <div className="md:col-span-12">
                  <img src={m.imageUrl} alt="미션 이미지" className={"w-full max-h-64 object-contain border rounded-xl " + (m.pixelate? 'pixelate':'')} />
                </div>
              )}
              <div className="md:col-span-12 text-xs text-slate-600 pt-1">
                정산 예상 XP: {Math.round(xpForMission(m, { extraMissionRate: settings.extraMissionRate, xpPenaltyRate: settings.xpPenaltyRate }))}
              </div>
            </div>
          ))}
          <div className="flex gap-2">
            <button className="btn" onClick={()=> addMission()}>➕ 새 미션 만들기</button>
            <button className="btn" onClick={()=> addMission({ title:'영단어 복습', category:'영어', plannedXp:20, pixelate:true })}>템플릿: 영어 복습</button>
            <button className="btn" onClick={()=> addMission({ title:'크로키 2장', category:'그림', plannedXp:35, pixelate:true })}>템플릿: 크로키</button>
          </div>
        </div>
      );
    }

    function Weekly({state, setState}){
      return (
        <div className="space-y-4">
          {state.weeklyGoals.map((g,i)=> (
            <div key={g.category} className="border rounded-xl p-3 grid md:grid-cols-12 items-center gap-3">
              <div className="md:col-span-3 font-medium">{g.category}</div>
              <div className="md:col-span-3 flex items-end gap-2">
                <div className="flex-1">
                  <div className="label">목표 횟수</div>
                  <input className="input" type="number" value={g.targetCount} onChange={e=>{
                    const v = Number(e.target.value);
                    setState(p=> ({...p, weeklyGoals: p.weeklyGoals.map((x,idx)=> idx===i? {...x, targetCount:v}: x)}));
                  }} />
                </div>
                <div className="flex-1">
                  <div className="label">달성(누적)</div>
                  <input className="input" type="number" value={g.achievedCount} onChange={e=>{
                    const v = Number(e.target.value);
                    setState(p=> ({...p, weeklyGoals: p.weeklyGoals.map((x,idx)=> idx===i? {...x, achievedCount:v}: x)}));
                  }} />
                </div>
              </div>
              <div className="md:col-span-6">
                <div className="h-2 bg-slate-200 rounded-xl overflow-hidden"><div className="h-full bg-slate-900" style={{width:`${Math.round(Math.min(1, g.achievedCount/Math.max(1,g.targetCount))*100)}%`}}/></div>
              </div>
            </div>
          ))}
          <div className="text-xs text-slate-600">* 주간 목표는 "하루 끝" 정산 시에만 자동 증가합니다. (수동 조정도 가능)</div>
        </div>
      );
    }

    function InventoryPanel({state, setState}){
      const keys = Object.keys(state.inventory.fragments);
      return (
        <div className="grid md:grid-cols-2 gap-4">
          <div className="card p-4">
            <div className="text-base font-semibold mb-2">🎲 조각</div>
            <div className="space-y-2">
              {keys.map(k=> (
                <div key={k} className="flex items-center justify-between">
                  <div>{k}</div>
                  <div className="flex items-center gap-2">
                    <span className="px-2 py-1 rounded-xl bg-slate-100">{state.inventory.fragments[k]}개</span>
                    <button className="btn" onClick={()=>{
                      setState(p=>{
                        const inv = JSON.parse(JSON.stringify(p.inventory));
                        inv.fragments[k] += 1;
                        while(inv.fragments[k] >= 5){ inv.fragments[k]-=5; inv.items[k]+=1; }
                        return {...p, inventory: inv};
                      });
                    }}>+1</button>
                  </div>
                </div>
              ))}
            </div>
          </div>
          <div className="card p-4">
            <div className="text-base font-semibold mb-2">✨ 완성 아이템</div>
            <div className="space-y-2">
              {Object.keys(state.inventory.items).map(k=> (
                <div key={k} className="flex items-center justify-between">
                  <div>{k}</div>
                  <span className="px-2 py-1 rounded-xl bg-slate-100">{state.inventory.items[k]}개</span>
                </div>
              ))}
            </div>
          </div>
          <div className="text-xs text-slate-600 md:col-span-2">* 미니보스 승리 시 무작위 조각 1개 획득. 조각 5개가 되면 자동으로 합성됩니다.</div>
        </div>
      );
    }

    function Recommended({onAdd}){
      const templates = [
        { title:'크로키 2장', category:'그림', plannedXp:35, pixelate:true, hint:'7주차 목표 5회' },
        { title:'유산소 운동 40분', category:'다이어트', plannedXp:40, pixelate:true, hint:'주 5회 루틴' },
        { title:'36시간 단식 준비/회복기록', category:'다이어트', plannedXp:25, hint:'주 2회' },
        { title:'스마트폰 디톡스 3시간', category:'생활 습관', plannedXp:30, hint:'주 3회' },
        { title:'영단어 암기 30분', category:'영어', plannedXp:25, pixelate:true, hint:'주 5회' },
        { title:'영어 영상 시청 20분', category:'영어', plannedXp:20, hint:'주 3회' },
        { title:'C 언어 강의 1강', category:'코딩/자격증', plannedXp:30, hint:'진도 마무리' },
        { title:'픽셀 아트 강의 1강', category:'그림', plannedXp:28, pixelate:true, hint:'주 3회' },
        { title:'인체 드로잉 책 복습', category:'그림', plannedXp:22, pixelate:true },
        { title:'독서 30쪽', category:'생활 교양', plannedXp:20, hint:'마의산/걸리버' },
        { title:'카드뉴스 3개', category:'생활 교양', plannedXp:15 },
      ];
      return (
        <div className="grid md:grid-cols-2 gap-3">
          {templates.map((t,i)=> (
            <div key={i} className="card p-4 flex items-center justify-between">
              <div>
                <div className="font-medium">✨ {t.title}</div>
                {t.hint && <div className="text-sm text-slate-600">{t.hint}</div>}
                <div className="text-xs text-slate-600 mt-1">카테고리: {t.category}</div>
              </div>
              <div className="flex items-center gap-2">
                <span className="px-2 py-1 rounded-xl bg-slate-100">XP {t.plannedXp}</span>
                <button className="btn btn-primary" onClick={()=> onAdd(t)}>담기</button>
              </div>
            </div>
          ))}
        </div>
      );
    }

    function Settings({state, setState}){
      const s = state.settings;
      return (
        <div className="grid md:grid-cols-2 gap-4">
          <div className="border rounded-xl p-3 space-y-3">
            <div className="grid grid-cols-2 gap-2 items-end">
              <div>
                <div className="label">실패 페널티(%)</div>
                <input className="input" type="number" value={Math.round(s.xpPenaltyRate*100)} onChange={e=> setState(p=>({...p, settings:{...p.settings, xpPenaltyRate: Number(e.target.value)/100 }}))} />
              </div>
              <div>
                <div className="label">추가 미션 보상(%)</div>
                <input className="input" type="number" value={Math.round(s.extraMissionRate*100)} onChange={e=> setState(p=>({...p, settings:{...p.settings, extraMissionRate: Number(e.target.value)/100 }}))} />
              </div>
            </div>
            <div className="grid grid-cols-2 gap-2 items-end">
              <div>
                <div className="label">미니보스 조각 보상</div>
                <input className="input" type="number" value={s.minibossRewardFragments} onChange={e=> setState(p=>({...p, settings:{...p.settings, minibossRewardFragments: Number(e.target.value) }}))} />
              </div>
              <div>
                <div className="label">표시 로케일</div>
                <input className="input" value={s.locale} onChange={e=> setState(p=>({...p, settings:{...p.settings, locale: e.target.value }}))} />
              </div>
            </div>
            <div className="flex items-center justify-between pt-2">
              <button className="btn" onClick={()=> { localStorage.removeItem(LS_KEY); setState({
                profile: { level: 8, xp: 309, nextLevelXp: 700 },
                weekNumber: 7,
                weeklyGoals: defaultWeeklyGoals,
                days: { [todayStr]: { date: todayStr, missions: seedMissions(), settled:false, dayXpAwarded:0 } },
                inventory: defaultInventory(),
                settings: { xpPenaltyRate:0.5, extraMissionRate:0.6, minibossRewardFragments:1, locale:'ko-KR' },
                quickNote: ''
              }); }}>모두 초기화</button>
              <div className="text-xs text-slate-500">브라우저에 자동 저장됩니다.</div>
            </div>
          </div>

          <div className="border rounded-xl p-3 space-y-3">
            <div className="text-sm font-medium">빠른 메모</div>
            <textarea className="input" rows="8" placeholder="그날의 컨디션, 깨달음, 회고 등을 기록하세요." value={state.quickNote} onChange={e=> setState(p=> ({...p, quickNote: e.target.value}))}></textarea>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App/>);
  </script>
</body>
</html>